
<script>
    $(document).ready(function () {
        function updateProductAndCategoryLists() {
            $.ajax({
                type: 'GET',
                url: '/update-product-categories',
                success: function(response) {
                    var products = response.product;
                    var categories = response.categoryProd;

                    var $productSelect = $('#exampleService');
                    var $categorySelect = $('#exampleCategoryService');

                    $productSelect.empty();
                    $categorySelect.empty();

                    products.forEach(function(product) {
                        $productSelect.append('<option value="' + product.id_product + '">' + product.name_product + '</option>');
                    });

                    categories.forEach(function(category) {
                        $categorySelect.append('<option value="' + category.id_category + '">' + category.name_category + '</option>');
                    });
                },
                error: function(error) {
                    toastr.error('Произошла ошибка при обновлении списка товаров и категорий!');
                }
            });
        }
        $('#createProductForm').submit(function (e) {
            e.preventDefault(); // Предотвращаем обычное поведение формы
            var formData = $(this).serialize(); // Сериализуем данные формы
            $.ajax({
                type: 'POST',
                url: '/createProduct', // Адрес обработчика формы на сервере
                data: formData,
                success: function (response) {
                    toastr.options.progressBar = true;
                    toastr.success('Услуга успешно добавлена!');
                    // Если запрос успешен, вы можете выполнить дополнительные действия здесь

                    $('#createProductForm').get(0).reset();
                    updateProductAndCategoryLists();
                },
                error: function (error) {
                    toastr.error('Произошла ошибка при добавлении услуги!');

                }
            });
        });

        $('#createCategoryProdForm').submit(function (e) {
            e.preventDefault(); // Предотвращаем обычное поведение формы
            var formData = $(this).serialize(); // Сериализуем данные формы
            $.ajax({
                type: 'POST',
                url: '/createCategoryProd', // Адрес обработчика формы на сервере
                data: formData,
                success: function (response) {
                    toastr.options.progressBar = true;
                    toastr.success('Категория успешно добавлена!');
                    // Если запрос успешен, вы можете выполнить дополнительные действия здесь

                    $('#createCategoryProdForm').get(0).reset();
                    updateProductAndCategoryLists();
                },
                error: function (error) {
                    toastr.error('Произошла ошибка при добавлении категории!');

                }
            });
        });

        $('#createProductCategoryForm').submit(function (e) {
            e.preventDefault(); // Предотвращаем обычное поведение формы
            var formData = $(this).serialize(); // Сериализуем данные формы
            $.ajax({
                type: 'POST',
                url: '/createProductCategory', // Адрес обработчика формы на сервере
                data: formData,
                success: function (response) {
                    toastr.options.progressBar = true;
                    toastr.success('Категория успешно добавлена к услуге!');
                    // Если запрос успешен, вы можете выполнить дополнительные действия здесь

                    // $('#createCategoryService').get(0).reset();
                },
                error: function (error) {
                    toastr.error('Произошла ошибка при добавлении категории к услуге!');

                }
            });
        });
    });
</script>
<div class="container">
    <div class="row mt-5">
        <div class="col-6 mx-auto">
            <form id="createProductForm"
                    method="post"
                    role="form"
                    th:action="@{/createProduct}"

            >
                <h1>Создать Продукт</h1>

                <div class="mb-3">
                    <label class="form-label" for="name_product">Название товара</label>
                    <input class="form-control" id="name_product" name="name_product" type="text">
                </div>
                <div class="mb-3">
                    <label class="form-label" for="price">Цена</label>
                    <input class="form-control" id="price" name="price">
                </div>
                <div class="mb-3">
                    <label class="form-label" for="description">Описание</label>
                    <textarea class="form-control" id="description"  name="description"></textarea>
                </div>
                <div class="mb-3">
                    <button class="btn mb-3" type="submit">Создать товар</button>
                </div>
            </form>
        </div>
        <div class="col-6 mx-auto">
            <form id="createCategoryProdForm"
                    method="post"
                    role="form"
                    th:action="@{/createCategoryProd}"

            >
                <h1>Создать категорию услуги</h1>

                <div class="mb-3">
                    <label class="form-label" for="name_category">Название категории </label>
                    <input class="form-control" id="name_category" name="name_category" type="text">
                </div>
                <div class="mb-3">
                    <button class="btn  mb-3" type="submit">Создать категорию</button>
                </div>
            </form>
        </div>
        <div class="col-6 mx-auto">
            <form id="createProductCategoryForm"
                    method="post"
                    role="form"
                    th:action="@{/createProductCategory}"

            >
                <h1>Добавить товар к категории</h1>
                <div class="form-group">
                    <label for="exampleService">Выберите товар</label>
                    <select class="form-control" id="exampleService" name="id_product">
                      <!--  <option   th:each="services : ${service}" th:value="services" th:text="${names.name_service}"></option>-->
                        <option th:each="products : ${product}" th:value="${products.id_product}"  th:text="${products.name_product}" ></option>

                        <!-- Добавьте здесь другие элементы, если нужно -->
                    </select>
                </div>
                <div class="form-group mb-3">
                    <label for="exampleCategoryService">Выберите категорию услуги</label>
                    <select class="form-control" id="exampleCategoryService" name="id_category_product">
                        <option th:each=" categoryProds: ${categoryProd}" th:value="${categoryProds.id_category}"  th:text="${categoryProds.name_category}"></option>

                        <!-- Добавьте здесь другие элементы, если нужно -->
                    </select>
                </div>
                <div class="mb-3">
                    <button class="btn  mb-3" type="submit">Добавить</button>
                </div>
            </form>
        </div>
    </div>
</div>
